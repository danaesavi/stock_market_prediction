\chapter{Introduction}
\label{ch:introsm}
\begin{chapterquote}{Richard Feynman}
"Nature uses only the longest threads to weave her patterns, so
that each small piece of her fabric reveals the organization of
the entire tapestry."
\end{chapterquote}
Forecasting is of great interest in different areas of scientific, industrial, and commercial activities. It involves working with time series in a lot cases. Time series are a collection of observations made sequentially through time \cite{chatfield2000time}. For example, the temperature in a specific region, the sales of a product in a store, and the electricity consumption in a fixed time interval.

Forecasting stock prices has been regarded as one of the most challenging applications of modern time series forecasting \cite{pai2005hybrid}. It involves a lot of uncertainties since its nature is essentially dynamic, non-linear, complicated, nonparametric, and chaotic. More important, financial forecasting is of great interest for investors since it helps to decide to invest in a stock or not as well as to sell it or not in order to get profits and avoid losing money.

The first attempt to describe a formula which expresses the likelihood of a market fluctuation was made by Louis Bachelier around one century ago. He was a young French mathematician convinced that the financial markets were a rich source of data for mathematicians and students of probability. 

Two other statisticians paid attention to stock market forecasting on the early 1900's. On 1934, Working found that although price levels do not follow a random pattern, price changes tend to be “largely random” \cite{bernstein1993capital}. Nineteen years later Kendall, confirmed Working's finding at his paper “The Analysis of Economic Time Series”. He declared that “the pattern of events in the price series was much less systematic than is generally believed” \cite{bernstein1993capital}. 

Although it may seem impossible to predict stock prices because of its seemingly random behavior, technical analysts believe that most information about the stocks is reflected in recent prices. Therefore, if trends in the movements are observed, then prices can be easily predicted \cite{patel2015predicting}. There are two types of analysis which usually investors perform before investing in a stock: fundamental analysis and technical analysis.

The fundamental analysis looks at intrinsic value of stocks, performance of the industry and economy, political climate etc. On the other hand, technical analysis is the evaluation of stocks by means of studying statistics generated by market activity. For example, past prices and volumes. Technical analysts use stock charts to identify patterns and trends that may suggest how a stock will behave in the future\cite{patel2015predicting}. This work focuses on this second type of analysis.

Stock market price forecasting models should be quick, adaptive, robust, and intuitive. A model that fits in all of these characteristics is the recurrent neural network. A recurrent neural network (RNN) is a neural network model proposed in the 80's for modeling time series \cite{pascanu2013difficulty}. Unlike standard artificial neural networks (ANN), it allows connections among hidden units associated with a time delay. Therefore, it can retain information about the past inputs. This characteristic makes the RNN model a great candidate for time series forecasting, and specifically, for stock market price forecasting.

Furthermore, RNN is a non- parametric model that, once trained, calculates the output very quickly. Parametric models assume forms of preset functions characterized by a number of parameters obtained from the sample. Conversely, non-parametric models have few assumptions about the form of the function.  

Traditional time series models like autoregressive moving average are parametric since they assume stationarity. Stationarity is a stochastic process where its parameters such as mean and variance do not change over time. Unfortunately, these barely happens in stock market prices. 

On the other hand, ANN is a very powerful machine learning model. However, it relies on the assumption of independence among the training and test examples \cite{lipton2015critical}. The state of the network is lost after processing each example. Commonly this is not a problem since each example is generated independently. But if a time or space relation exists between the examples as in this case, this is unacceptable.

RNNs do not make the stationary assumption and do not assume independence among the training and test examples. As stated before, they retain information about past inputs. This is why RNNs are widely used for time series applications, handwriting recognition \cite{graves2009offline}, speech recognition \cite{graves2013generating}, scene labeling \cite{pinheiro2014recurrent}, and forecasting stock markets \cite{hsieh2011forecasting}. 

\section{Objectives}
Design and implement a time series model for stock market price prediction using a recurrent neural network.

Compare the performance of the recurrent neural network model with two other predictive machine learning models, specifically, a feed forward artificial neural network model and a support vector machine model.

\section{Related Work}

A lot of research has been done around financial forecasting. Studies can be divided in two types of predictive models: traditional statistical models and machine learning models.

The first type includes the moving average, exponential smoothing, and the  autoregressive integrated moving average (ARIMA) models. These kind of models are linear in their predictions of the future values. They analyze historic data and attempt to approximate future values of a time series as a linear combination of these historic data \cite{shah2014performance}. 

On the other hand, artificial Neural Networks (ANN) and Support Vector Regression (SVR) are two machine learning algorithms widely used for predicting stock price values \cite{patel2015predicting}. Machine Learning uses a set of samples to generate an approximation of the underling function that generated the data \cite{shah2014performance}.

In \cite{shah2014performance} they compared the performance of multilayer feed-forward neural network and the Elman neural network as representative of recurrent neural network for stock prediction. They found the neural network  better than Elman recurrent network and suggested to only use Elman model for historical data and research purposes. On the other hand, in \cite{kim2003financial} a support vector machine model was applied to predict the stock price index. Their experimental results showed that SVM provides a promising alternative to stock market prediction as it outperformed back-propagation neural network .

Researchers have also tried hybrid models, meaning a combination of two or more models that can be machine learning and/or traditional statistical models. In \cite{pai2005hybrid} a hybrid model of autoregressive integrated moving average (ARIMA) and a support vector machine model is presented to solve the stock price forecasting problem. They found that a simple combination of the individual models does not necessarily produce the best results and demonstrated great interest in the selection of optimal parameters for the model.

Another hybrid model is presented in \cite{rather2015recurrent}. Its model was constituted of two linear models,  ARIMA and exponential smoothing model and a non-linear model, recurrent neural network. Their results confirm the accuracy of the prediction performance of recurrent neural network compared to linear models.

This work compares the performance of two machine learning models: artificial neural network (ANN), support vector machine (SVM),  and a deep learning model: recurrent neural network (RNN) with long short term memory networks (LSTM). ANN and SVM have been widely used for stock market forecasting and RNN with LSTM is a good option for problems where data is non-linear  as in this case, and where the patterns are difficult to be captured by traditional models.

\section{Scope}
In this study a novel stock market price prediction model is presented. This approach does not seek to get a number of next predictions but just the next one. Meaning, it requires a number $n$ of real past predictions and determines the $n+1$ price in the sequence. 

Another limitation is that just machine learning models were taken in account. Traditional models such as ARIMA are not compared. Finally, stock market’s movements are affected by many macro-economical factors such as political events, general economic conditions, bank exchange rates, investors’ expectations, and so on. The data used for training this models just incorporates the prices of a fixed time interval.

The rest of this work is organized as follows. In the next chapter machine learning and deep learning are introduced. First, we explain the McCulloch and Pitts's Neuron model in order to easily understand the traditional neural networks. Then, we explain support vector machine as an optimization of neural networks.

Next, we move to deep learning and study the recurrent neural networks as well as some techniques to optimize them. This includes regularization, gradient descent variants and gradient descent optimization algorithms.  

In  chapter 3, we explore the data and show how we can represent stock market prices as time series vectors. Then, we select the right parameters for each model and explain the criteria and metrics used to compare the models. Chapter 4 exhibits and analyzes  the results of the experiments and, finally, we draw the conclusions and propose future work at the final chapter.

